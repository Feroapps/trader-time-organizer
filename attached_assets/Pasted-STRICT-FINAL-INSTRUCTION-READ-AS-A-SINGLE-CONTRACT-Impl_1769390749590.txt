STRICT & FINAL INSTRUCTION — READ AS A SINGLE CONTRACT

Implement alarm-like behavior ONLY for user-created alerts on Android and iOS. “User-created” means alerts where isFixed === false; Session Alerts (isFixed === true) must remain completely untouched. Do not change appId, packageName, storage schema, IndexedDB/localStorage content, alert time calculations, scheduling rules, or any existing behavior outside what is explicitly described here. No refactoring. No UI redesign of existing screens.

Alarm-like behavior applies ONLY to user-created alerts that are enabled; disabled user-created alerts must not be scheduled and must not be re-scheduled after reboot. When an enabled user-created alert triggers, it must alert the user continuously until the user explicitly interacts or until 120 seconds pass. Any user interaction that opens the alarm UI (including tapping the notification or navigating to the alarm screen) must immediately stop the current ringing or reminder loop and cancel any remaining scheduled alarm instances for that alert, but this interaction must NOT be treated as a permanent Stop; the user must still be able to choose Snooze. If the user presses Stop, the alarm stops permanently and MUST cancel all pending alarm instances and reminder notifications for that same alert (including any scheduled snooze instance). If the user presses Snooze, the alarm is rescheduled to now + snoozeMinutes. If the user does nothing, the alarm stops automatically after exactly 120 seconds and MUST NOT snooze automatically.

Add a Snooze setting ONLY for user-created alerts. This setting appears ONLY inside the existing Add Alert screen, using the exact same UI components, layout, spacing, and styling already present. Do not add screens, sections, toggles, or reorder anything in existing screens. Add exactly one new row labeled “Snooze” with fixed options 60, 120, and 180 minutes. Default is 60 minutes. No other values are allowed.

Persist snoozeMinutes only when creating or editing a user-created alert. If snoozeMinutes is missing in existing data, treat it at runtime as 60. Do not migrate or rewrite all existing records.

On Android, enabled user-created alerts must use a real native alarm implementation (AlarmManager + Foreground Service). The alarm must ring and vibrate continuously until user interaction, Stop, Snooze, or 120 seconds elapse. Snooze schedules the next alarm at now + snoozeMinutes. Stop cancels any pending scheduled alarm for that alertId. Do not rely on notification channel sounds for continuous ringing. On Android versions where exact alarms require user permission or system allowance, handle this explicitly and gracefully without changing alert logic: request or guide the user as required, and never silently downgrade to inexact alarms.

On iOS, implement the closest equivalent allowed by the system: an initial notification at trigger time followed by repeated reminder notifications within a total window of 120 seconds if the user does not interact. All reminder notifications for a single alert must be tied to the same alertId so they can be canceled together. When the user opens the notification, immediately stop any ongoing reminder loop and show the Alarm UI with Stop and Snooze. Do not redesign existing UI; adding a single minimal Alarm screen (Stop/Snooze) is allowed ONLY if required for functionality, and it must reuse the existing design system/components without altering any existing screens’ layout. Snooze schedules a new notification series at now + snoozeMinutes, and Stop cancels the remaining scheduled reminders for that alertId.

Enabled user-created alarms must persist across device reboot. After reboot and on app startup, re-schedule only the pending enabled user-created alarms using existing stored data, without modifying alert logic, timing, or UI.

This alarm/snooze behavior must not affect Session Alerts, normal notification behavior for fixed alerts, or any other logic. Deliverables are a list of files changed and explicit confirmation that only one UI row was added, the design of existing screens is unchanged, snooze values are exactly 60/120/180 with default 60, and Session Alerts were not modified.